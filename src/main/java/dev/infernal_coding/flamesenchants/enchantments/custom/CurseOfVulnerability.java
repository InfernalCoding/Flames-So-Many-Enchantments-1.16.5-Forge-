package dev.infernal_coding.flamesenchants.enchantments.custom;

import dev.infernal_coding.flamesenchants.FlamesEnchants;
import dev.infernal_coding.flamesenchants.Registry;
import net.minecraft.enchantment.Enchantment;
import net.minecraft.enchantment.EnchantmentHelper;
import net.minecraft.enchantment.EnchantmentType;
import net.minecraft.inventory.EquipmentSlotType;
import net.minecraftforge.event.entity.living.LivingDamageEvent;
import net.minecraftforge.eventbus.api.EventPriority;
import net.minecraftforge.eventbus.api.SubscribeEvent;
import net.minecraftforge.fml.common.Mod;

public class CurseOfVulnerability extends Enchantment {
    public CurseOfVulnerability() {
        super(Rarity.VERY_RARE, EnchantmentType.ARMOR, new EquipmentSlotType[]{EquipmentSlotType.HEAD, EquipmentSlotType.CHEST, EquipmentSlotType.LEGS, EquipmentSlotType.FEET});
    }

    @Override
    public int getMaxLevel() {
        return 4;
    }

    @Override
    public int getMinEnchantability(int par1) {
        return 20 + (par1 - 1) * 10;
    }

    @Override
    public boolean isCurse() {
        return true;
    }

    public boolean isAllowedOnBooks() {
        return false;
    }


    @Override
    public int getMaxEnchantability(int par1) {
        return this.getMinEnchantability(par1) + 30;
    }

    public static void onDamage(LivingDamageEvent e) {
        if (e.getEntityLiving() != null) {
            int level = EnchantmentHelper.getMaxEnchantmentLevel(Registry.CURSE_OF_VULNERABILITY.get(), e.getEntityLiving());
            if (level > 0) {
                e.setAmount(e.getAmount() * (1.0F + (float)level * 0.4F));
            }
        }
    }
}
